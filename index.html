<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Gerencial Completo - Docks del Puerto Tigre</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-blue: #4285f4;
            --primary-red: #ea4335;
            --primary-yellow: #fbbc05;
            --primary-green: #34a853;
            --shadow-light: 0 2px 4px rgba(0,0,0,0.1);
            --shadow-medium: 0 4px 8px rgba(0,0,0,0.15);
            --shadow-heavy: 0 8px 16px rgba(0,0,0,0.2);
        }

        .btn-3d {
            background: linear-gradient(145deg, var(--primary-blue), #3367d6);
            box-shadow: var(--shadow-medium);
            transform: translateY(0);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: none;
            color: white;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
        }

        .btn-3d:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-heavy);
        }

        .btn-3d:active {
            transform: translateY(0);
            box-shadow: var(--shadow-light);
        }

        .btn-red { background: linear-gradient(145deg, var(--primary-red), #d33b2c); }
        .btn-yellow { background: linear-gradient(145deg, var(--primary-yellow), #e0a408); }
        .btn-green { background: linear-gradient(145deg, var(--primary-green), #2d8e47); }

        .card-3d {
            background: white;
            box-shadow: var(--shadow-medium);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .card-3d:hover {
            box-shadow: var(--shadow-heavy);
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .logo-docks {
            font-size: 2rem;
            font-weight: bold;
            color: #5a5a5a;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-houses {
            display: flex;
            gap: 2px;
        }

        .house {
            width: 20px;
            height: 20px;
            position: relative;
        }

        .house-red { background: var(--primary-red); }
        .house-green { background: var(--primary-green); }
        .house-yellow { background: var(--primary-yellow); }
        .house-blue { background: var(--primary-blue); }

        .chart-container {
            height: 300px;
            position: relative;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status-ocupado { background: #d1fae5; color: #065f46; }
        .status-libre { background: #fee2e2; color: #991b1b; }
        .status-mantenimiento { background: #fef3c7; color: #92400e; }
        .status-pagado { background: #dbeafe; color: #1e40af; }
        .status-pendiente { background: #fde68a; color: #92400e; }
        .status-vencido { background: #fecaca; color: #991b1b; }
        .status-proceso { background: #e0e7ff; color: #3730a3; }
        .status-resuelto { background: #d1fae5; color: #065f46; }

        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
        }

        .metric-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transform: translate(25px, -25px);
        }

        .section-hidden { display: none; }
        .tab-active { 
            background: var(--primary-blue); 
            color: white; 
            box-shadow: var(--shadow-medium);
        }

        .input-group {
            margin-bottom: 1rem;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #374151;
        }

        .input-group input, .input-group select, .input-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus, .input-group textarea:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(66, 133, 244, 0.1);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow-light);
            font-size: 0.9rem;
        }

        .data-table th {
            background: #f1f5f9;
            padding: 0.75rem;
            text-align: left;
            font-weight: 600;
            color: #475569;
            border-bottom: 2px solid #e2e8f0;
        }

        .data-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #e2e8f0;
        }

        .data-table tr:hover {
            background: #f8fafc;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 2rem;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow-heavy);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: black;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            padding: 1rem;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            display: none;
        }

        .notification.success { background: var(--primary-green); }
        .notification.error { background: var(--primary-red); }
        .notification.warning { background: var(--primary-yellow); }
        .notification.info { background: var(--primary-blue); }

        .priority-high { border-left: 4px solid #ef4444; }
        .priority-medium { border-left: 4px solid #f59e0b; }
        .priority-low { border-left: 4px solid #10b981; }

        .google-sheets-config {
            background: #f8fafc;
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            margin: 1rem 0;
        }

        @media (max-width: 768px) {
            .logo-docks { font-size: 1.5rem; }
            .metric-card { padding: 1rem; }
            .data-table { font-size: 0.8rem; }
            .modal-content { margin: 10% auto; width: 95%; }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Loading Screen -->
    <div id="loadingScreen" class="fixed inset-0 bg-white z-50 flex items-center justify-center">
        <div class="text-center">
            <div class="animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500 mb-4"></div>
            <p class="text-gray-600">Cargando Sistema Completo...</p>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <!-- Login Screen -->
    <div id="loginSection" class="min-h-screen flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8">
        <div class="max-w-md w-full space-y-8">
            <div class="logo-container">
                <div class="logo-docks">
                    <div class="logo-houses">
                        <div class="house house-red"></div>
                        <div class="house house-green"></div>
                        <div class="house house-yellow"></div>
                        <div class="house house-blue"></div>
                    </div>
                    <div style="margin-left: 1rem;">
                        <div>DOCKS <span style="font-weight: normal;">DEL</span> PUERTO</div>
                        <div style="font-size: 0.8rem; font-weight: normal; margin-top: -0.2rem;">TIGRE</div>
                    </div>
                </div>
            </div>
            
            <div class="card-3d p-8">
                <h2 class="text-center text-3xl font-extrabold text-gray-900 mb-6">
                    Sistema Gerencial Completo
                </h2>
                
                <div class="space-y-4">
                    <div class="input-group">
                        <label for="tipoUsuario">Tipo de Usuario</label>
                        <select id="tipoUsuario" onchange="cambiarTipoUsuario()">
                            <option value="gerente">Gerente</option>
                            <option value="locatario">Locatario</option>
                        </select>
                    </div>

                    <div id="loginGerente">
                        <div class="input-group">
                            <label for="usuario">Usuario Gerente</label>
                            <input id="usuario" type="text" placeholder="Ingrese usuario" value="gerente">
                        </div>
                        
                        <div class="input-group">
                            <label for="password">Contraseña</label>
                            <input id="password" type="password" placeholder="Ingrese contraseña" value="admin123">
                        </div>
                    </div>

                    <div id="loginLocatario" class="section-hidden">
                        <div class="input-group">
                            <label for="numeroLocal">Número de Local</label>
                            <input id="numeroLocal" type="text" placeholder="Ej: 001">
                        </div>
                        
                        <div class="input-group">
                            <label for="nombreLocatario">Nombre del Locatario</label>
                            <input id="nombreLocatario" type="text" placeholder="Nombre completo">
                        </div>
                    </div>
                    
                    <button onclick="login()" class="w-full btn-3d text-white font-bold py-3 px-4 rounded-lg">
                        <i class="fas fa-sign-in-alt mr-2"></i>
                        Acceder al Sistema
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main System -->
    <div id="mainSystem" class="section-hidden">
        <!-- Header -->
        <header class="bg-white shadow-lg">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="logo-docks" style="font-size: 1.5rem;">
                        <div class="logo-houses">
                            <div class="house house-red"></div>
                            <div class="house house-green"></div>
                            <div class="house house-yellow"></div>
                            <div class="house house-blue"></div>
                        </div>
                        <div style="margin-left: 0.8rem;">
                            <div>DOCKS <span style="font-weight: normal;">DEL</span> PUERTO</div>
                            <div style="font-size: 0.6rem; font-weight: normal;">SISTEMA GERENCIAL COMPLETO</div>
                        </div>
                    </div>
                    
                    <div class="flex items-center space-x-4">
                        <span id="userWelcome" class="text-gray-700">Bienvenido, <strong id="userName">Usuario</strong></span>
                        <button onclick="openGoogleSheetsConfig()" class="btn-3d btn-green text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-cog mr-2"></i>Google Sheets
                        </button>
                        <button onclick="logout()" class="btn-3d btn-red text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-sign-out-alt mr-2"></i>Salir
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="bg-white border-b">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex space-x-8 overflow-x-auto">
                    <button onclick="showSection('dashboard')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap tab-active">
                        <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                    </button>
                    <button onclick="showSection('locales-inversores')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap">
                        <i class="fas fa-building mr-2"></i>Locales Inversores
                    </button>
                    <button onclick="showSection('locales-docks')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap">
                        <i class="fas fa-store mr-2"></i>Locales Docks
                    </button>
                    <button onclick="showSection('expensas')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap">
                        <i class="fas fa-receipt mr-2"></i>Expensas
                    </button>
                    <button onclick="showSection('gastos')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap">
                        <i class="fas fa-chart-line mr-2"></i>Gastos Operativos
                    </button>
                    <button onclick="showSection('reclamos')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap">
                        <i class="fas fa-exclamation-circle mr-2"></i>Reclamos
                    </button>
                    <button onclick="showSection('sugerencias')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap">
                        <i class="fas fa-lightbulb mr-2"></i>Sugerencias
                    </button>
                    <button onclick="showSection('reportes')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap">
                        <i class="fas fa-chart-bar mr-2"></i>Reportes
                    </button>
                </div>
            </div>
        </nav>

        <!-- Tenant Navigation (Hidden by default) -->
        <nav id="tenantNav" class="bg-blue-50 border-b section-hidden">
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex space-x-8 overflow-x-auto">
                    <button onclick="showSection('portal-locatario')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap tab-active">
                        <i class="fas fa-home mr-2"></i>Mi Portal
                    </button>
                    <button onclick="showSection('mis-reclamos')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap">
                        <i class="fas fa-exclamation-circle mr-2"></i>Mis Reclamos
                    </button>
                    <button onclick="showSection('mis-sugerencias')" class="tab-button py-4 px-2 text-sm font-medium whitespace-nowrap">
                        <i class="fas fa-lightbulb mr-2"></i>Mis Sugerencias
                    </button>
                </div>
            </div>
        </nav>

        <div class="max-w-7xl mx-auto px-4 py-8">
            <!-- Dashboard Section -->
            <section id="dashboard">
                <h1 class="text-3xl font-bold text-gray-900 mb-8">Dashboard Ejecutivo</h1>
                
                <!-- KPI Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="metric-card">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">Total Locales</p>
                                <p class="text-3xl font-bold" id="totalLocales">200</p>
                            </div>
                            <i class="fas fa-store text-2xl opacity-80"></i>
                        </div>
                    </div>
                    
                    <div class="metric-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">Ingresos Mensuales</p>
                                <p class="text-3xl font-bold" id="ingresosMensuales">$2.5M</p>
                            </div>
                            <i class="fas fa-dollar-sign text-2xl opacity-80"></i>
                        </div>
                    </div>
                    
                    <div class="metric-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">Reclamos Pendientes</p>
                                <p class="text-3xl font-bold" id="reclamosPendientes">12</p>
                            </div>
                            <i class="fas fa-exclamation-triangle text-2xl opacity-80"></i>
                        </div>
                    </div>
                    
                    <div class="metric-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm opacity-90">Ocupación</p>
                                <p class="text-3xl font-bold" id="ocupacion">92%</p>
                            </div>
                            <i class="fas fa-chart-pie text-2xl opacity-80"></i>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                    <div class="card-3d p-6">
                        <h3 class="text-xl font-bold mb-4">Ingresos por Categoría</h3>
                        <div class="chart-container">
                            <canvas id="incomeChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="card-3d p-6">
                        <h3 class="text-xl font-bold mb-4">Reclamos por Categoría</h3>
                        <div class="chart-container">
                            <canvas id="complaintsChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="card-3d p-6">
                    <h3 class="text-xl font-bold mb-4">Actividad Reciente</h3>
                    <div id="recentActivity" class="space-y-4">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </section>

            <!-- Locales Inversores Section -->
            <section id="locales-inversores" class="section-hidden">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-900">Locales de Inversores</h1>
                    <button onclick="openInvestorModal()" class="btn-3d text-white px-6 py-3 rounded-lg">
                        <i class="fas fa-plus mr-2"></i>Agregar Local Inversor
                    </button>
                </div>

                <!-- Investor Locales Table -->
                <div class="card-3d overflow-hidden">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Local</th>
                                <th>Inversor</th>
                                <th>Locatario</th>
                                <th>M²</th>
                                <th>Tipo Contrato</th>
                                <th>Comisión</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="investorLocalesTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Locales Docks Section -->
            <section id="locales-docks" class="section-hidden">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-900">Locales Propios Docks</h1>
                    <button onclick="openDocksModal()" class="btn-3d text-white px-6 py-3 rounded-lg">
                        <i class="fas fa-plus mr-2"></i>Registrar Local Propio
                    </button>
                </div>

                <!-- Docks Locales Table -->
                <div class="card-3d overflow-hidden">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Local</th>
                                <th>Locatario</th>
                                <th>Rubro</th>
                                <th>M²</th>
                                <th>Alquiler Mensual</th>
                                <th>Estado</th>
                                <th>Rentabilidad</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="docksLocalesTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Expensas Section -->
            <section id="expensas" class="section-hidden">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-900">Gestión de Expensas</h1>
                    <button onclick="generateExpenses()" class="btn-3d btn-green text-white px-6 py-3 rounded-lg">
                        <i class="fas fa-calculator mr-2"></i>Generar Liquidación
                    </button>
                </div>

                <!-- Expense Summary -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="card-3d p-6">
                        <div class="flex items-center">
                            <i class="fas fa-money-bill-wave text-blue-500 text-3xl mr-4"></i>
                            <div>
                                <h3 class="text-xl font-bold text-gray-900" id="totalExpensasMes">$785,000</h3>
                                <p class="text-gray-600">Total Expensas Mes</p>
                            </div>
                        </div>
                    </div>
                    <div class="card-3d p-6">
                        <div class="flex items-center">
                            <i class="fas fa-check-circle text-green-500 text-3xl mr-4"></i>
                            <div>
                                <h3 class="text-xl font-bold text-gray-900" id="expensasCobradas">$520,000</h3>
                                <p class="text-gray-600">Cobrado</p>
                            </div>
                        </div>
                    </div>
                    <div class="card-3d p-6">
                        <div class="flex items-center">
                            <i class="fas fa-exclamation-circle text-red-500 text-3xl mr-4"></i>
                            <div>
                                <h3 class="text-xl font-bold text-gray-900" id="expensasPendientes">$265,000</h3>
                                <p class="text-gray-600">Pendiente</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Expensas Table -->
                <div class="card-3d overflow-hidden">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Local</th>
                                <th>Locatario</th>
                                <th>M²</th>
                                <th>Coeficiente</th>
                                <th>Expensa Mensual</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="expensasTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Gastos Operativos Section -->
            <section id="gastos" class="section-hidden">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-900">Gastos Operativos</h1>
                    <button onclick="openExpenseOperationalModal()" class="btn-3d text-white px-6 py-3 rounded-lg">
                        <i class="fas fa-plus mr-2"></i>Registrar Gasto
                    </button>
                </div>

                <!-- Budget Overview -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-wallet text-blue-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="presupuestoMensual">$950,000</h3>
                        <p class="text-gray-600">Presupuesto Mensual</p>
                    </div>
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-credit-card text-red-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="gastado">$785,500</h3>
                        <p class="text-gray-600">Gastado</p>
                    </div>
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-piggy-bank text-green-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="disponible">$164,500</h3>
                        <p class="text-gray-600">Disponible</p>
                    </div>
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-chart-line text-purple-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="ejecucion">83%</h3>
                        <p class="text-gray-600">Ejecución</p>
                    </div>
                </div>

                <!-- Gastos Table -->
                <div class="card-3d overflow-hidden">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Fecha</th>
                                <th>Concepto</th>
                                <th>Categoría</th>
                                <th>Proveedor</th>
                                <th>Monto</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="gastosTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Reclamos Section -->
            <section id="reclamos" class="section-hidden">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-900">Gestión de Reclamos</h1>
                    <div class="flex space-x-4">
                        <select id="filtroEstadoReclamo" onchange="filtrarReclamos()">
                            <option value="">Todos los estados</option>
                            <option value="pendiente">Pendientes</option>
                            <option value="proceso">En Proceso</option>
                            <option value="resuelto">Resueltos</option>
                        </select>
                        <select id="filtroCategoriaReclamo" onchange="filtrarReclamos()">
                            <option value="">Todas las categorías</option>
                            <option value="mantenimiento">Mantenimiento</option>
                            <option value="servicios">Servicios</option>
                            <option value="seguridad">Seguridad</option>
                            <option value="limpieza">Limpieza</option>
                            <option value="administracion">Administración</option>
                            <option value="otros">Otros</option>
                        </select>
                    </div>
                </div>

                <!-- Reclamos Summary -->
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-exclamation-circle text-red-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="totalReclamos">45</h3>
                        <p class="text-gray-600">Total Reclamos</p>
                    </div>
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-clock text-yellow-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="reclamosPendientesCount">12</h3>
                        <p class="text-gray-600">Pendientes</p>
                    </div>
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-cogs text-blue-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="reclamosProcesoCount">8</h3>
                        <p class="text-gray-600">En Proceso</p>
                    </div>
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-check-circle text-green-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="reclamosResueltosCount">25</h3>
                        <p class="text-gray-600">Resueltos</p>
                    </div>
                </div>

                <!-- Reclamos Table -->
                <div class="card-3d overflow-hidden">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Fecha</th>
                                <th>Local</th>
                                <th>Locatario</th>
                                <th>Categoría</th>
                                <th>Prioridad</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="reclamosTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Sugerencias Section -->
            <section id="sugerencias" class="section-hidden">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-900">Gestión de Sugerencias</h1>
                    <select id="filtroTipoSugerencia" onchange="filtrarSugerencias()">
                        <option value="">Todos los tipos</option>
                        <option value="mejoras">Mejoras</option>
                        <option value="eventos">Eventos</option>
                        <option value="servicios">Servicios Nuevos</option>
                        <option value="otros">Otros</option>
                    </select>
                </div>

                <!-- Sugerencias Summary -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-lightbulb text-yellow-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="totalSugerencias">28</h3>
                        <p class="text-gray-600">Total Sugerencias</p>
                    </div>
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-star text-purple-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="sugerenciasImplementadas">15</h3>
                        <p class="text-gray-600">Implementadas</p>
                    </div>
                    <div class="card-3d p-6 text-center">
                        <i class="fas fa-eye text-blue-500 text-3xl mb-4"></i>
                        <h3 class="text-2xl font-bold text-gray-900" id="sugerenciasRevisadas">13</h3>
                        <p class="text-gray-600">En Revisión</p>
                    </div>
                </div>

                <!-- Sugerencias Table -->
                <div class="card-3d overflow-hidden">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Fecha</th>
                                <th>Local</th>
                                <th>Locatario</th>
                                <th>Tipo</th>
                                <th>Título</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="sugerenciasTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Portal Locatario Section -->
            <section id="portal-locatario" class="section-hidden">
                <h1 class="text-3xl font-bold text-gray-900 mb-8">Portal del Locatario</h1>
                
                <!-- Quick Actions -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                    <div class="card-3d p-8 text-center cursor-pointer hover:bg-blue-50" onclick="openReclamoModal()">
                        <i class="fas fa-exclamation-circle text-red-500 text-6xl mb-4"></i>
                        <h3 class="text-2xl font-bold mb-2">Enviar Reclamo</h3>
                        <p class="text-gray-600">Reporta problemas o inconvenientes</p>
                    </div>
                    <div class="card-3d p-8 text-center cursor-pointer hover:bg-green-50" onclick="openSugerenciaModal()">
                        <i class="fas fa-lightbulb text-yellow-500 text-6xl mb-4"></i>
                        <h3 class="text-2xl font-bold mb-2">Enviar Sugerencia</h3>
                        <p class="text-gray-600">Propón mejoras o nuevas ideas</p>
                    </div>
                </div>

                <!-- Tenant Info -->
                <div class="card-3d p-6">
                    <h3 class="text-xl font-bold mb-4">Información del Local</h3>
                    <div id="tenantInfo" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <!-- Dynamic content -->
                    </div>
                </div>
            </section>

            <!-- Mis Reclamos Section -->
            <section id="mis-reclamos" class="section-hidden">
                <h1 class="text-3xl font-bold text-gray-900 mb-8">Mis Reclamos</h1>
                
                <div class="card-3d overflow-hidden">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Fecha</th>
                                <th>Categoría</th>
                                <th>Descripción</th>
                                <th>Estado</th>
                                <th>Respuesta</th>
                            </tr>
                        </thead>
                        <tbody id="misReclamosTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Mis Sugerencias Section -->
            <section id="mis-sugerencias" class="section-hidden">
                <h1 class="text-3xl font-bold text-gray-900 mb-8">Mis Sugerencias</h1>
                
                <div class="card-3d overflow-hidden">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Fecha</th>
                                <th>Tipo</th>
                                <th>Título</th>
                                <th>Estado</th>
                                <th>Comentarios</th>
                            </tr>
                        </thead>
                        <tbody id="misSugerenciasTable">
                            <!-- Dynamic content -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Reportes Section -->
            <section id="reportes" class="section-hidden">
                <h1 class="text-3xl font-bold text-gray-900 mb-8">Reportes Ejecutivos</h1>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="card-3d p-6 text-center cursor-pointer hover:bg-blue-50" onclick="generateReport('financial')">
                        <i class="fas fa-chart-line text-blue-500 text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Reporte Financiero</h3>
                        <p class="text-gray-600 mb-4">Ingresos, gastos y rentabilidad</p>
                        <button class="btn-3d text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-download mr-2"></i>Generar
                        </button>
                    </div>
                    
                    <div class="card-3d p-6 text-center cursor-pointer hover:bg-green-50" onclick="generateReport('occupancy')">
                        <i class="fas fa-building text-green-500 text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Reporte de Ocupación</h3>
                        <p class="text-gray-600 mb-4">Estado de locales y tendencias</p>
                        <button class="btn-3d btn-green text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-download mr-2"></i>Generar
                        </button>
                    </div>
                    
                    <div class="card-3d p-6 text-center cursor-pointer hover:bg-yellow-50" onclick="generateReport('complaints')">
                        <i class="fas fa-exclamation-circle text-red-500 text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Reporte de Reclamos</h3>
                        <p class="text-gray-600 mb-4">Análisis de reclamos y resolución</p>
                        <button class="btn-3d btn-red text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-download mr-2"></i>Generar
                        </button>
                    </div>
                    
                    <div class="card-3d p-6 text-center cursor-pointer hover:bg-purple-50" onclick="generateReport('suggestions')">
                        <i class="fas fa-lightbulb text-yellow-500 text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Reporte de Sugerencias</h3>
                        <p class="text-gray-600 mb-4">Ideas y mejoras implementadas</p>
                        <button class="btn-3d btn-yellow text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-download mr-2"></i>Generar
                        </button>
                    </div>
                    
                    <div class="card-3d p-6 text-center cursor-pointer hover:bg-indigo-50" onclick="generateReport('expenses')">
                        <i class="fas fa-receipt text-purple-500 text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Reporte de Expensas</h3>
                        <p class="text-gray-600 mb-4">Liquidaciones y cobros</p>
                        <button class="btn-3d" style="background: linear-gradient(145deg, #8b5cf6, #7c3aed);" class="text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-download mr-2"></i>Generar
                        </button>
                    </div>
                    
                    <div class="card-3d p-6 text-center cursor-pointer hover:bg-gray-50" onclick="exportAllData()">
                        <i class="fas fa-database text-gray-500 text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Exportar Todo</h3>
                        <p class="text-gray-600 mb-4">Backup completo del sistema</p>
                        <button class="btn-3d" style="background: linear-gradient(145deg, #6b7280, #4b5563);" class="text-white px-4 py-2 rounded-lg">
                            <i class="fas fa-download mr-2"></i>Exportar
                        </button>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Google Sheets Configuration Modal -->
    <div id="googleSheetsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('googleSheetsModal')">&times;</span>
            <h2 class="text-2xl font-bold mb-6">Configuración Google Sheets</h2>
            
            <div class="google-sheets-config">
                <i class="fas fa-google text-4xl text-green-500 mb-4"></i>
                <h3 class="text-lg font-bold">Conectar con Google Sheets</h3>
                <p class="text-gray-600 mb-4">Para habilitar la sincronización automática de datos</p>
            </div>

            <div class="input-group">
                <label for="googleScriptUrl">URL del Google Apps Script</label>
                <input id="googleScriptUrl" type="url" placeholder="https://script.google.com/macros/s/...">
                <small class="text-gray-500">Instrucciones: Crear Google Apps Script y pegar la URL aquí</small>
            </div>

            <div class="input-group">
                <label for="spreadsheetId">ID de la Hoja de Cálculo</label>
                <input id="spreadsheetId" type="text" placeholder="1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms">
            </div>

            <div class="flex space-x-4">
                <button onclick="testGoogleSheetsConnection()" class="btn-3d btn-yellow text-white px-4 py-2 rounded-lg">
                    <i class="fas fa-vial mr-2"></i>Probar Conexión
                </button>
                <button onclick="saveGoogleSheetsConfig()" class="btn-3d btn-green text-white px-4 py-2 rounded-lg">
                    <i class="fas fa-save mr-2"></i>Guardar Configuración
                </button>
            </div>
        </div>
    </div>

    <!-- Reclamo Modal -->
    <div id="reclamoModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('reclamoModal')">&times;</span>
            <h2 class="text-2xl font-bold mb-6">Nuevo Reclamo</h2>
            
            <form id="reclamoForm">
                <div class="input-group">
                    <label for="reclamoCategoria">Categoría</label>
                    <select id="reclamoCategoria" required>
                        <option value="">Seleccionar categoría</option>
                        <option value="mantenimiento">Mantenimiento</option>
                        <option value="servicios">Servicios</option>
                        <option value="seguridad">Seguridad</option>
                        <option value="limpieza">Limpieza</option>
                        <option value="administracion">Administración</option>
                        <option value="otros">Otros</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="reclamoPrioridad">Prioridad</label>
                    <select id="reclamoPrioridad" required>
                        <option value="baja">Baja</option>
                        <option value="media" selected>Media</option>
                        <option value="alta">Alta</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="reclamoTitulo">Título del Reclamo</label>
                    <input id="reclamoTitulo" type="text" placeholder="Resumen del problema" required>
                </div>

                <div class="input-group">
                    <label for="reclamoDescripcion">Descripción Detallada</label>
                    <textarea id="reclamoDescripcion" rows="4" placeholder="Describe el problema en detalle" required></textarea>
                </div>

                <div class="flex space-x-4">
                    <button type="button" onclick="closeModal('reclamoModal')" class="btn-3d" style="background: #6b7280;">Cancelar</button>
                    <button type="submit" class="btn-3d btn-red text-white">
                        <i class="fas fa-paper-plane mr-2"></i>Enviar Reclamo
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sugerencia Modal -->
    <div id="sugerenciaModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('sugerenciaModal')">&times;</span>
            <h2 class="text-2xl font-bold mb-6">Nueva Sugerencia</h2>
            
            <form id="sugerenciaForm">
                <div class="input-group">
                    <label for="sugerenciaTipo">Tipo de Sugerencia</label>
                    <select id="sugerenciaTipo" required>
                        <option value="">Seleccionar tipo</option>
                        <option value="mejoras">Mejoras</option>
                        <option value="eventos">Eventos</option>
                        <option value="servicios">Servicios Nuevos</option>
                        <option value="otros">Otros</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="sugerenciaTitulo">Título de la Sugerencia</label>
                    <input id="sugerenciaTitulo" type="text" placeholder="Título de tu idea" required>
                </div>

                <div class="input-group">
                    <label for="sugerenciaDescripcion">Descripción</label>
                    <textarea id="sugerenciaDescripcion" rows="4" placeholder="Describe tu sugerencia o idea" required></textarea>
                </div>

                <div class="input-group">
                    <label for="sugerenciaBeneficios">Beneficios Esperados</label>
                    <textarea id="sugerenciaBeneficios" rows="3" placeholder="¿Qué beneficios traería esta sugerencia?"></textarea>
                </div>

                <div class="flex space-x-4">
                    <button type="button" onclick="closeModal('sugerenciaModal')" class="btn-3d" style="background: #6b7280;">Cancelar</button>
                    <button type="submit" class="btn-3d btn-yellow text-white">
                        <i class="fas fa-lightbulb mr-2"></i>Enviar Sugerencia
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Global Variables
        let currentUser = null;
        let userType = 'gerente';
        let googleSheetsConfig = {
            scriptUrl: '',
            spreadsheetId: ''
        };

        // Data Storage
        let systemData = {
            localesInversores: [
                {id: '001', inversor: 'Rodriguez S.A.', locatario: 'Café Central', metros: 45, tipoContrato: 'Administración', comision: '15%', estado: 'Ocupado', vence: 'Mar 2025'},
                {id: '025', inversor: 'Inversiones Delta', locatario: 'Boutique Elegance', metros: 32, tipoContrato: 'Renta Fija', comision: '$120,000', estado: 'Ocupado', vence: 'Jun 2025'},
                {id: '078', inversor: 'Grupo Inmobiliario Sur', locatario: '', metros: 28, tipoContrato: 'Porcentaje', comision: '12%', estado: 'Libre', vence: ''}
            ],
            localesDocks: [
                {id: '002', locatario: 'Panadería El Sol', rubro: 'Gastronomía', metros: 38, alquiler: '$95,000', estado: 'Ocupado', vence: 'Dic 2024', rentabilidad: '85%'},
                {id: '015', locatario: 'Farmacia Vital', rubro: 'Salud', metros: 42, alquiler: '$110,000', estado: 'Ocupado', vence: 'Feb 2025', rentabilidad: '92%'},
                {id: '089', locatario: '', rubro: '', metros: 35, alquiler: '', estado: 'Libre', vence: '', rentabilidad: '0%'}
            ],
            expensas: [
                {local: '001', locatario: 'Café Central', metros: 45, coeficiente: '1.2%', monto: '$9,420', estado: 'Pagado', fecha: '15/11/2024'},
                {local: '025', locatario: 'Boutique Elegance', metros: 32, coeficiente: '0.85%', monto: '$6,672', estado: 'Pendiente', fecha: ''},
                {local: '078', locatario: '', metros: 28, coeficiente: '0.74%', monto: '$5,810', estado: 'Exento', fecha: ''}
            ],
            gastos: [
                {id: 1, fecha: '20/11/2024', concepto: 'Mantenimiento Aires Acondicionados', categoria: 'Mantenimiento', proveedor: 'Climatización Sur', monto: '$85,000', estado: 'Pagado'},
                {id: 2, fecha: '18/11/2024', concepto: 'Salarios Personal Seguridad', categoria: 'Personal', proveedor: 'Seguridad Total SA', monto: '$180,000', estado: 'Pagado'},
                {id: 3, fecha: '15/11/2024', concepto: 'Factura Electricidad', categoria: 'Servicios', proveedor: 'EDENOR', monto: '$125,000', estado: 'Pendiente'}
            ],
            reclamos: [
                {id: 'R001', fecha: '22/11/2024', local: '001', locatario: 'Café Central', categoria: 'mantenimiento', titulo: 'Aire acondicionado no funciona', prioridad: 'alta', estado: 'pendiente', descripcion: 'El equipo de aire acondicionado del local se descompuso', respuesta: ''},
                {id: 'R002', fecha: '20/11/2024', local: '025', locatario: 'Boutique Elegance', categoria: 'limpieza', titulo: 'Baños sucios', prioridad: 'media', estado: 'proceso', descripcion: 'Los baños comunes necesitan mejor limpieza', respuesta: 'Personal de limpieza asignado'},
                {id: 'R003', fecha: '18/11/2024', local: '015', locatario: 'Farmacia Vital', categoria: 'seguridad', titulo: 'Problema con cámaras', prioridad: 'alta', estado: 'resuelto', descripcion: 'Las cámaras de seguridad no graban correctamente', respuesta: 'Cámaras reparadas y funcionando'}
            ],
            sugerencias: [
                {id: 'S001', fecha: '21/11/2024', local: '001', locatario: 'Café Central', tipo: 'eventos', titulo: 'Festival gastronómico', descripcion: 'Organizar un festival de comida en el centro comercial', beneficios: 'Atraería más clientes', estado: 'revision', comentarios: ''},
                {id: 'S002', fecha: '19/11/2024', local: '025', locatario: 'Boutique Elegance', tipo: 'mejoras', titulo: 'Música ambiental', descripcion: 'Instalar sistema de música en áreas comunes', beneficios: 'Mejor ambiente para compras', estado: 'implementado', comentarios: 'Sistema instalado exitosamente'},
                {id: 'S003', fecha: '17/11/2024', local: '015', locatario: 'Farmacia Vital', tipo: 'servicios', titulo: 'WiFi gratuito', descripcion: 'Ofrecer WiFi gratuito para clientes', beneficios: 'Mayor permanencia de clientes', estado: 'revision', comentarios: 'Evaluando costos'}
            ]
        };

        // Initialize System
        window.onload = function() {
            loadFromLocalStorage();
            setTimeout(() => {
                document.getElementById('loadingScreen').style.display = 'none';
            }, 2000);
        };

        // Authentication Functions
        function cambiarTipoUsuario() {
            const tipo = document.getElementById('tipoUsuario').value;
            userType = tipo;
            
            if (tipo === 'gerente') {
                document.getElementById('loginGerente').classList.remove('section-hidden');
                document.getElementById('loginLocatario').classList.add('section-hidden');
            } else {
                document.getElementById('loginGerente').classList.add('section-hidden');
                document.getElementById('loginLocatario').classList.remove('section-hidden');
            }
        }

        function login() {
            if (userType === 'gerente') {
                const usuario = document.getElementById('usuario').value;
                const password = document.getElementById('password').value;
                
                if (usuario === 'gerente' && password === 'admin123') {
                    currentUser = {tipo: 'gerente', nombre: 'Gerente'};
                    document.getElementById('userName').textContent = 'Gerente';
                    document.getElementById('loginSection').classList.add('section-hidden');
                    document.getElementById('mainSystem').classList.remove('section-hidden');
                    document.getElementById('tenantNav').classList.add('section-hidden');
                    showSection('dashboard');
                    initCharts();
                    loadData();
                    showNotification('Bienvenido al sistema gerencial', 'success');
                } else {
                    showNotification('Usuario o contraseña incorrectos', 'error');
                }
            } else {
                const numeroLocal = document.getElementById('numeroLocal').value;
                const nombreLocatario = document.getElementById('nombreLocatario').value;
                
                if (numeroLocal && nombreLocatario) {
                    currentUser = {tipo: 'locatario', nombre: nombreLocatario, local: numeroLocal};
                    document.getElementById('userName').textContent = nombreLocatario;
                    document.getElementById('loginSection').classList.add('section-hidden');
                    document.getElementById('mainSystem').classList.remove('section-hidden');
                    document.getElementById('tenantNav').classList.remove('section-hidden');
                    
                    // Hide manager sections
                    const managerSections = ['locales-inversores', 'locales-docks', 'expensas', 'gastos', 'reclamos', 'sugerencias', 'reportes'];
                    managerSections.forEach(section => {
                        document.querySelector(`[onclick="showSection('${section}')"]`).style.display = 'none';
                    });
                    
                    showSection('portal-locatario');
                    loadTenantData();
                    showNotification(`Bienvenido ${nombreLocatario}`, 'success');
                } else {
                    showNotification('Complete todos los campos', 'error');
                }
            }
        }

        function logout() {
            currentUser = null;
            document.getElementById('loginSection').classList.remove('section-hidden');
            document.getElementById('mainSystem').classList.add('section-hidden');
            document.getElementById('usuario').value = 'gerente';
            document.getElementById('password').value = 'admin123';
            showNotification('Sesión cerrada exitosamente', 'info');
        }

        // Navigation Functions
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('section');
            sections.forEach(section => section.classList.add('section-hidden'));
            
            // Show selected section
            document.getElementById(sectionId).classList.remove('section-hidden');
            
            // Update tab styles
            const tabs = document.querySelectorAll('.tab-button');
            tabs.forEach(tab => tab.classList.remove('tab-active'));
            
            // Find and activate current tab
            const activeTab = document.querySelector(`[onclick="showSection('${sectionId}')"]`);
            if (activeTab) {
                activeTab.classList.add('tab-active');
            }
            
            // Load section-specific data
            if (sectionId === 'dashboard') initCharts();
            if (sectionId === 'reclamos') loadReclamos();
            if (sectionId === 'sugerencias') loadSugerencias();
        }

        // Data Loading Functions
        function loadData() {
            loadInvestorLocales();
            loadDocksLocales();
            loadExpensas();
            loadGastos();
            loadReclamos();
            loadSugerencias();
            updateDashboardKPIs();
            loadRecentActivity();
        }

        function loadTenantData() {
            loadTenantInfo();
            loadMisReclamos();
            loadMisSugerencias();
        }

        function loadInvestorLocales() {
            const tbody = document.getElementById('investorLocalesTable');
            tbody.innerHTML = '';
            
            systemData.localesInversores.forEach(local => {
                const row = `
                    <tr>
                        <td><strong>${local.id}</strong></td>
                        <td>${local.inversor}</td>
                        <td>${local.locatario || '-'}</td>
                        <td>${local.metros} m²</td>
                        <td><span class="status-badge ${getStatusClass(local.tipoContrato)}">${local.tipoContrato}</span></td>
                        <td>${local.comision}</td>
                        <td><span class="status-badge ${getStatusClass(local.estado)}">${local.estado}</span></td>
                        <td>
                            <button onclick="editLocal('${local.id}', 'investor')" class="btn-3d btn-yellow text-white px-3 py-1 rounded mr-2">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="viewContract('${local.id}')" class="btn-3d text-white px-3 py-1 rounded">
                                <i class="fas fa-file-contract"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function loadDocksLocales() {
            const tbody = document.getElementById('docksLocalesTable');
            tbody.innerHTML = '';
            
            systemData.localesDocks.forEach(local => {
                const row = `
                    <tr>
                        <td><strong>${local.id}</strong></td>
                        <td>${local.locatario || '-'}</td>
                        <td>${local.rubro || '-'}</td>
                        <td>${local.metros} m²</td>
                        <td>${local.alquiler || '-'}</td>
                        <td><span class="status-badge ${getStatusClass(local.estado)}">${local.estado}</span></td>
                        <td><span class="${local.rentabilidad === '0%' ? 'text-red-600' : 'text-green-600'} font-bold">${local.rentabilidad}</span></td>
                        <td>
                            <button onclick="editLocal('${local.id}', 'docks')" class="btn-3d btn-yellow text-white px-3 py-1 rounded mr-2">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="renewContract('${local.id}')" class="btn-3d btn-green text-white px-3 py-1 rounded">
                                <i class="fas fa-sync"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function loadExpensas() {
            const tbody = document.getElementById('expensasTable');
            tbody.innerHTML = '';
            
            systemData.expensas.forEach(expensa => {
                const row = `
                    <tr>
                        <td><strong>${expensa.local}</strong></td>
                        <td>${expensa.locatario || '-'}</td>
                        <td>${expensa.metros} m²</td>
                        <td>${expensa.coeficiente}</td>
                        <td>${expensa.monto}</td>
                        <td><span class="status-badge ${getStatusClass(expensa.estado)}">${expensa.estado}</span></td>
                        <td>
                            <button onclick="viewExpenseDetail('${expensa.local}')" class="btn-3d text-white px-3 py-1 rounded">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function loadGastos() {
            const tbody = document.getElementById('gastosTable');
            tbody.innerHTML = '';
            
            systemData.gastos.forEach(gasto => {
                const row = `
                    <tr>
                        <td>${gasto.fecha}</td>
                        <td>${gasto.concepto}</td>
                        <td><span class="status-badge" style="background: ${getCategoryColor(gasto.categoria)};">${gasto.categoria}</span></td>
                        <td>${gasto.proveedor}</td>
                        <td>${gasto.monto}</td>
                        <td><span class="status-badge ${getStatusClass(gasto.estado)}">${gasto.estado}</span></td>
                        <td>
                            <button onclick="viewGastoDetail(${gasto.id})" class="btn-3d text-white px-3 py-1 rounded">
                                <i class="fas fa-eye"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function loadReclamos() {
            const tbody = document.getElementById('reclamosTable');
            tbody.innerHTML = '';
            
            let filteredReclamos = systemData.reclamos;
            
            const estadoFiltro = document.getElementById('filtroEstadoReclamo')?.value;
            const categoriaFiltro = document.getElementById('filtroCategoriaReclamo')?.value;
            
            if (estadoFiltro) {
                filteredReclamos = filteredReclamos.filter(r => r.estado === estadoFiltro);
            }
            
            if (categoriaFiltro) {
                filteredReclamos = filteredReclamos.filter(r => r.categoria === categoriaFiltro);
            }
            
            filteredReclamos.forEach(reclamo => {
                const row = `
                    <tr class="priority-${reclamo.prioridad}">
                        <td><strong>${reclamo.id}</strong></td>
                        <td>${reclamo.fecha}</td>
                        <td>${reclamo.local}</td>
                        <td>${reclamo.locatario}</td>
                        <td><span class="status-badge" style="background: ${getCategoryColor(reclamo.categoria)};">${reclamo.categoria}</span></td>
                        <td><span class="status-badge ${getPriorityClass(reclamo.prioridad)}">${reclamo.prioridad.toUpperCase()}</span></td>
                        <td><span class="status-badge ${getStatusClass(reclamo.estado)}">${reclamo.estado}</span></td>
                        <td>
                            <button onclick="viewReclamoDetail('${reclamo.id}')" class="btn-3d text-white px-3 py-1 rounded mr-2">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button onclick="updateReclamoStatus('${reclamo.id}')" class="btn-3d btn-green text-white px-3 py-1 rounded">
                                <i class="fas fa-check"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });

            updateReclamosKPIs();
        }

        function loadSugerencias() {
            const tbody = document.getElementById('sugerenciasTable');
            tbody.innerHTML = '';
            
            let filteredSugerencias = systemData.sugerencias;
            
            const tipoFiltro = document.getElementById('filtroTipoSugerencia')?.value;
            if (tipoFiltro) {
                filteredSugerencias = filteredSugerencias.filter(s => s.tipo === tipoFiltro);
            }
            
            filteredSugerencias.forEach(sugerencia => {
                const row = `
                    <tr>
                        <td><strong>${sugerencia.id}</strong></td>
                        <td>${sugerencia.fecha}</td>
                        <td>${sugerencia.local}</td>
                        <td>${sugerencia.locatario}</td>
                        <td><span class="status-badge" style="background: ${getCategoryColor(sugerencia.tipo)};">${sugerencia.tipo}</span></td>
                        <td>${sugerencia.titulo}</td>
                        <td><span class="status-badge ${getStatusClass(sugerencia.estado)}">${sugerencia.estado}</span></td>
                        <td>
                            <button onclick="viewSugerenciaDetail('${sugerencia.id}')" class="btn-3d text-white px-3 py-1 rounded mr-2">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button onclick="updateSugerenciaStatus('${sugerencia.id}')" class="btn-3d btn-green text-white px-3 py-1 rounded">
                                <i class="fas fa-star"></i>
                            </button>
                        </td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });

            updateSugerenciasKPIs();
        }

        function loadTenantInfo() {
            const container = document.getElementById('tenantInfo');
            if (!currentUser || currentUser.tipo !== 'locatario') return;
            
            const local = findLocalByNumber(currentUser.local);
            if (!local) return;
            
            container.innerHTML = `
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h4 class="font-bold text-gray-800">Local ${local.id}</h4>
                    <p class="text-gray-600">Locatario: ${currentUser.nombre}</p>
                    <p class="text-gray-600">Metros: ${local.metros} m²</p>
                    <p class="text-gray-600">Estado: <span class="status-badge ${getStatusClass(local.estado)}">${local.estado}</span></p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h4 class="font-bold text-blue-800">Información de Contacto</h4>
                    <p class="text-blue-600">Administración: (011) 4567-8900</p>
                    <p class="text-blue-600">Email: admin@dockstigre.com</p>
                    <p class="text-blue-600">Emergencias: (011) 4567-8901</p>
                </div>
            `;
        }

        function loadMisReclamos() {
            if (!currentUser || currentUser.tipo !== 'locatario') return;
            
            const tbody = document.getElementById('misReclamosTable');
            const misReclamos = systemData.reclamos.filter(r => r.local === currentUser.local);
            
            tbody.innerHTML = '';
            misReclamos.forEach(reclamo => {
                const row = `
                    <tr>
                        <td><strong>${reclamo.id}</strong></td>
                        <td>${reclamo.fecha}</td>
                        <td>${reclamo.categoria}</td>
                        <td>${reclamo.titulo}</td>
                        <td><span class="status-badge ${getStatusClass(reclamo.estado)}">${reclamo.estado}</span></td>
                        <td>${reclamo.respuesta || 'Pendiente de respuesta'}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function loadMisSugerencias() {
            if (!currentUser || currentUser.tipo !== 'locatario') return;
            
            const tbody = document.getElementById('misSugerenciasTable');
            const misSugerencias = systemData.sugerencias.filter(s => s.local === currentUser.local);
            
            tbody.innerHTML = '';
            misSugerencias.forEach(sugerencia => {
                const row = `
                    <tr>
                        <td><strong>${sugerencia.id}</strong></td>
                        <td>${sugerencia.fecha}</td>
                        <td>${sugerencia.tipo}</td>
                        <td>${sugerencia.titulo}</td>
                        <td><span class="status-badge ${getStatusClass(sugerencia.estado)}">${sugerencia.estado}</span></td>
                        <td>${sugerencia.comentarios || 'En revisión'}</td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        function loadRecentActivity() {
            const container = document.getElementById('recentActivity');
            const activities = [
                {icon: 'fas fa-dollar-sign text-green-500', text: 'Pago recibido - Local 045', time: 'Hace 2 horas', amount: '+$85,000', color: 'text-green-600'},
                {icon: 'fas fa-exclamation-circle text-red-500', text: 'Nuevo reclamo - Local 001', time: 'Hace 3 horas', amount: 'Urgente', color: 'text-red-600'},
                {icon: 'fas fa-lightbulb text-yellow-500', text: 'Nueva sugerencia - Local 025', time: 'Hace 4 horas', amount: 'Revisión', color: 'text-yellow-600'},
                {icon: 'fas fa-wrench text-blue-500', text: 'Mantenimiento programado - Área común', time: 'Hace 5 horas', amount: '-$25,000', color: 'text-blue-600'}
            ];
            
            container.innerHTML = '';
            activities.forEach(activity => {
                const div = document.createElement('div');
                div.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg';
                div.innerHTML = `
                    <div class="flex items-center">
                        <i class="${activity.icon} mr-3"></i>
                        <div>
                            <p class="font-medium">${activity.text}</p>
                            <p class="text-sm text-gray-500">${activity.time}</p>
                        </div>
                    </div>
                    <span class="${activity.color} font-bold">${activity.amount}</span>
                `;
                container.appendChild(div);
            });
        }

        // Chart Functions
        function initCharts() {
            initIncomeChart();
            initComplaintsChart();
        }

        function initIncomeChart() {
            const ctx = document.getElementById('incomeChart');
            if (!ctx) return;
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Locales Propios', 'Comisiones Inversores', 'Expensas', 'Otros'],
                    datasets: [{
                        data: [1800000, 450000, 785000, 120000],
                        backgroundColor: ['#4285f4', '#ea4335', '#fbbc05', '#34a853'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function initComplaintsChart() {
            const ctx = document.getElementById('complaintsChart');
            if (!ctx) return;
            
            const categoryCounts = {};
            systemData.reclamos.forEach(reclamo => {
                categoryCounts[reclamo.categoria] = (categoryCounts[reclamo.categoria] || 0) + 1;
            });
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(categoryCounts),
                    datasets: [{
                        label: 'Cantidad de Reclamos',
                        data: Object.values(categoryCounts),
                        backgroundColor: '#ea4335',
                        borderColor: '#d33b2c',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        // Modal Functions
        function openReclamoModal() {
            document.getElementById('reclamoModal').style.display = 'block';
        }

        function openSugerenciaModal() {
            document.getElementById('sugerenciaModal').style.display = 'block';
        }

        function openGoogleSheetsConfig() {
            document.getElementById('googleSheetsModal').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Form Handlers
        document.getElementById('reclamoForm').onsubmit = function(e) {
            e.preventDefault();
            
            const nuevoReclamo = {
                id: 'R' + String(systemData.reclamos.length + 1).padStart(3, '0'),
                fecha: new Date().toLocaleDateString('es-ES'),
                local: currentUser.local,
                locatario: currentUser.nombre,
                categoria: document.getElementById('reclamoCategoria').value,
                titulo: document.getElementById('reclamoTitulo').value,
                prioridad: document.getElementById('reclamoPrioridad').value,
                estado: 'pendiente',
                descripcion: document.getElementById('reclamoDescripcion').value,
                respuesta: ''
            };
            
            systemData.reclamos.push(nuevoReclamo);
            saveToLocalStorage();
            syncWithGoogleSheets('reclamos', nuevoReclamo);
            
            closeModal('reclamoModal');
            document.getElementById('reclamoForm').reset();
            loadMisReclamos();
            showNotification('Reclamo enviado exitosamente', 'success');
        };

        document.getElementById('sugerenciaForm').onsubmit = function(e) {
            e.preventDefault();
            
            const nuevaSugerencia = {
                id: 'S' + String(systemData.sugerencias.length + 1).padStart(3, '0'),
                fecha: new Date().toLocaleDateString('es-ES'),
                local: currentUser.local,
                locatario: currentUser.nombre,
                tipo: document.getElementById('sugerenciaTipo').value,
                titulo: document.getElementById('sugerenciaTitulo').value,
                descripcion: document.getElementById('sugerenciaDescripcion').value,
                beneficios: document.getElementById('sugerenciaBeneficios').value,
                estado: 'revision',
                comentarios: ''
            };
            
            systemData.sugerencias.push(nuevaSugerencia);
            saveToLocalStorage();
            syncWithGoogleSheets('sugerencias', nuevaSugerencia);
            
            closeModal('sugerenciaModal');
            document.getElementById('sugerenciaForm').reset();
            loadMisSugerencias();
            showNotification('Sugerencia enviada exitosamente', 'success');
        };

        // Utility Functions
        function getStatusClass(status) {
            const statusMap = {
                'Ocupado': 'status-ocupado',
                'Libre': 'status-libre',
                'Mantenimiento': 'status-mantenimiento',
                'Pagado': 'status-pagado',
                'Pendiente': 'status-pendiente',
                'Exento': 'status-libre',
                'pendiente': 'status-pendiente',
                'proceso': 'status-proceso',
                'resuelto': 'status-resuelto',
                'revision': 'status-pendiente',
                'implementado': 'status-resuelto'
            };
            return statusMap[status] || 'status-pendiente';
        }

        function getPriorityClass(priority) {
            const priorityMap = {
                'alta': 'status-vencido',
                'media': 'status-pendiente',
                'baja': 'status-ocupado'
            };
            return priorityMap[priority] || 'status-pendiente';
        }

        function getCategoryColor(category) {
            const colorMap = {
                'Mantenimiento': '#fef3c7; color: #92400e',
                'Personal': '#dbeafe; color: #1e40af',
                'Servicios': '#d1fae5; color: #065f46',
                'mantenimiento': '#fef3c7; color: #92400e',
                'servicios': '#dbeafe; color: #1e40af',
                'seguridad': '#fee2e2; color: #991b1b',
                'limpieza': '#d1fae5; color: #065f46',
                'administracion': '#e0e7ff; color: #3730a3',
                'otros': '#f3f4f6; color: #374151',
                'mejoras': '#dbeafe; color: #1e40af',
                'eventos': '#fef3c7; color: #92400e',
                'servicios': '#d1fae5; color: #065f46'
            };
            return colorMap[category] || '#f3f4f6; color: #374151';
        }

        function findLocalByNumber(numero) {
            let local = systemData.localesInversores.find(l => l.id === numero);
            if (!local) {
                local = systemData.localesDocks.find(l => l.id === numero);
            }
            return local;
        }

        function updateDashboardKPIs() {
            // Update total locales
            const totalLocales = systemData.localesInversores.length + systemData.localesDocks.length;
            document.getElementById('totalLocales').textContent = totalLocales;
            
            // Update reclamos pendientes
            const reclamosPendientes = systemData.reclamos.filter(r => r.estado === 'pendiente').length;
            document.getElementById('reclamosPendientes').textContent = reclamosPendientes;
        }

        function updateReclamosKPIs() {
            document.getElementById('totalReclamos').textContent = systemData.reclamos.length;
            document.getElementById('reclamosPendientesCount').textContent = systemData.reclamos.filter(r => r.estado === 'pendiente').length;
            document.getElementById('reclamosProcesoCount').textContent = systemData.reclamos.filter(r => r.estado === 'proceso').length;
            document.getElementById('reclamosResueltosCount').textContent = systemData.reclamos.filter(r => r.estado === 'resuelto').length;
        }

        function updateSugerenciasKPIs() {
            document.getElementById('totalSugerencias').textContent = systemData.sugerencias.length;
            document.getElementById('sugerenciasImplementadas').textContent = systemData.sugerencias.filter(s => s.estado === 'implementado').length;
            document.getElementById('sugerenciasRevisadas').textContent = systemData.sugerencias.filter(s => s.estado === 'revision').length;
        }

        // Filter Functions
        function filtrarReclamos() {
            loadReclamos();
        }

        function filtrarSugerencias() {
            loadSugerencias();
        }

        // Action Functions
        function viewReclamoDetail(id) {
            const reclamo = systemData.reclamos.find(r => r.id === id);
            if (!reclamo) return;
            
            alert(`
RECLAMO ${reclamo.id}
Fecha: ${reclamo.fecha}
Local: ${reclamo.local}
Locatario: ${reclamo.locatario}
Categoría: ${reclamo.categoria}
Prioridad: ${reclamo.prioridad.toUpperCase()}

Título: ${reclamo.titulo}

Descripción: ${reclamo.descripcion}

Estado: ${reclamo.estado.toUpperCase()}
Respuesta: ${reclamo.respuesta || 'Sin respuesta aún'}
            `);
        }

        function updateReclamoStatus(id) {
            const reclamo = systemData.reclamos.find(r => r.id === id);
            if (!reclamo) return;
            
            const newStatus = prompt('Nuevo estado (pendiente/proceso/resuelto):', reclamo.estado);
            if (newStatus && ['pendiente', 'proceso', 'resuelto'].includes(newStatus)) {
                reclamo.estado = newStatus;
                
                if (newStatus === 'resuelto') {
                    const respuesta = prompt('Respuesta/Solución implementada:');
                    if (respuesta) {
                        reclamo.respuesta = respuesta;
                    }
                }
                
                saveToLocalStorage();
                loadReclamos();
                showNotification('Estado del reclamo actualizado', 'success');
            }
        }

        function viewSugerenciaDetail(id) {
            const sugerencia = systemData.sugerencias.find(s => s.id === id);
            if (!sugerencia) return;
            
            alert(`
SUGERENCIA ${sugerencia.id}
Fecha: ${sugerencia.fecha}
Local: ${sugerencia.local}
Locatario: ${sugerencia.locatario}
Tipo: ${sugerencia.tipo}

Título: ${sugerencia.titulo}

Descripción: ${sugerencia.descripcion}

Beneficios Esperados: ${sugerencia.beneficios}

Estado: ${sugerencia.estado.toUpperCase()}
Comentarios: ${sugerencia.comentarios || 'En revisión'}
            `);
        }

        function updateSugerenciaStatus(id) {
            const sugerencia = systemData.sugerencias.find(s => s.id === id);
            if (!sugerencia) return;
            
            const newStatus = prompt('Nuevo estado (revision/implementado/descartado):', sugerencia.estado);
            if (newStatus && ['revision', 'implementado', 'descartado'].includes(newStatus)) {
                sugerencia.estado = newStatus;
                
                const comentarios = prompt('Comentarios:');
                if (comentarios) {
                    sugerencia.comentarios = comentarios;
                }
                
                saveToLocalStorage();
                loadSugerencias();
                showNotification('Estado de la sugerencia actualizado', 'success');
            }
        }

        // Google Sheets Integration
        function saveGoogleSheetsConfig() {
            const scriptUrl = document.getElementById('https://script.google.com/macros/s/AKfycbzHsbHNtD2r7G4MLPYg9XuYpyrtEZ8M2SyMthsdj3xTcxI32bjaaNuEQyoTtMLSs3xS/exec').value;
            const spreadsheetId = document.getElementById('1HJ1ONrYianB-DImUJJ7OfSQV3gxA2VGGuOY9gRs1ytI').value;
            
            if (scriptUrl && spreadsheetId) {
                googleSheetsConfig.scriptUrl = scriptUrl;
                googleSheetsConfig.spreadsheetId = spreadsheetId;
                
                localStorage.setItem('googleSheetsConfig', JSON.stringify(googleSheetsConfig));
                closeModal('googleSheetsModal');
                showNotification('Configuración de Google Sheets guardada', 'success');
            } else {
                showNotification('Complete todos los campos', 'error');
            }
        }

        function testGoogleSheetsConnection() {
            const scriptUrl = document.getElementById('googleScriptUrl').value;
            
            if (!scriptUrl) {
                showNotification('Ingrese la URL del Google Apps Script', 'error');
                return;
            }
            
            // Test connection
            fetch(scriptUrl + '?action=test')
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        showNotification('Conexión exitosa con Google Sheets', 'success');
                    } else {
                        showNotification('Error en la conexión: ' + data.message, 'error');
                    }
                })
                .catch(error => {
                    showNotification('Error de conexión con Google Sheets', 'error');
                });
        }

        function syncWithGoogleSheets(type, data) {
            if (!googleSheetsConfig.scriptUrl) return;
            
            const payload = {
                action: 'add',
                type: type,
                data: data
            };
            
            fetch(googleSheetsConfig.scriptUrl, {
                method: 'POST',
                body: JSON.stringify(payload)
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    console.log('Data synced with Google Sheets');
                } else {
                    console.error('Error syncing with Google Sheets:', result.message);
                }
            })
            .catch(error => {
                console.error('Error syncing with Google Sheets:', error);
            });
        }

        // Data Persistence
        function saveToLocalStorage() {
            localStorage.setItem('docksSystemData', JSON.stringify(systemData));
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('docksSystemData');
            if (saved) {
                systemData = {...systemData, ...JSON.parse(saved)};
            }
            
            const savedConfig = localStorage.getItem('googleSheetsConfig');
            if (savedConfig) {
                googleSheetsConfig = JSON.parse(savedConfig);
                document.getElementById('googleScriptUrl').value = googleSheetsConfig.scriptUrl || '';
                document.getElementById('spreadsheetId').value = googleSheetsConfig.spreadsheetId || '';
            }
        }

        // Report Functions
        function generateReport(type) {
            let reportData = '';
            let filename = '';
            
            switch(type) {
                case 'financial':
                    reportData = generateFinancialReport();
                    filename = 'reporte_financiero.csv';
                    break;
                case 'occupancy':
                    reportData = generateOccupancyReport();
                    filename = 'reporte_ocupacion.csv';
                    break;
                case 'complaints':
                    reportData = generateComplaintsReport();
                    filename = 'reporte_reclamos.csv';
                    break;
                case 'suggestions':
                    reportData = generateSuggestionsReport();
                    filename = 'reporte_sugerencias.csv';
                    break;
                case 'expenses':
                    reportData = generateExpensesReport();
                    filename = 'reporte_expensas.csv';
                    break;
            }
            
            downloadCSV(reportData, filename);
            showNotification('Reporte generado y descargado', 'success');
        }

        function generateFinancialReport() {
            let csv = 'Tipo,Local,Concepto,Monto,Fecha\n';
            
            // Add rental income
            systemData.localesDocks.forEach(local => {
                if (local.alquiler && local.estado === 'Ocupado') {
                    csv += `Ingreso,${local.id},Alquiler ${local.locatario},${local.alquiler},${new Date().toLocaleDateString()}\n`;
                }
            });
            
            // Add expenses
            systemData.gastos.forEach(gasto => {
                csv += `Gasto,${gasto.categoria},${gasto.concepto},${gasto.monto},${gasto.fecha}\n`;
            });
            
            return csv;
        }

        function generateComplaintsReport() {
            let csv = 'ID,Fecha,Local,Locatario,Categoria,Prioridad,Estado,Titulo,Descripcion\n';
            
            systemData.reclamos.forEach(reclamo => {
                csv += `${reclamo.id},${reclamo.fecha},${reclamo.local},${reclamo.locatario},${reclamo.categoria},${reclamo.prioridad},${reclamo.estado},"${reclamo.titulo}","${reclamo.descripcion}"\n`;
            });
            
            return csv;
        }

        function generateSuggestionsReport() {
            let csv = 'ID,Fecha,Local,Locatario,Tipo,Titulo,Estado,Descripcion\n';
            
            systemData.sugerencias.forEach(sugerencia => {
                csv += `${sugerencia.id},${sugerencia.fecha},${sugerencia.local},${sugerencia.locatario},${sugerencia.tipo},"${sugerencia.titulo}",${sugerencia.estado},"${sugerencia.descripcion}"\n`;
            });
            
            return csv;
        }

        function generateOccupancyReport() {
            let csv = 'Local,Locatario,Estado,Metros,Tipo\n';
            
            systemData.localesInversores.forEach(local => {
                csv += `${local.id},${local.locatario || 'Vacío'},${local.estado},${local.metros},Inversor\n`;
            });
            
            systemData.localesDocks.forEach(local => {
                csv += `${local.id},${local.locatario || 'Vacío'},${local.estado},${local.metros},Propio\n`;
            });
            
            return csv;
        }

        function generateExpensesReport() {
            let csv = 'Local,Locatario,Metros,Coeficiente,Monto,Estado,Fecha\n';
            
            systemData.expensas.forEach(expensa => {
                csv += `${expensa.local},${expensa.locatario || 'Vacío'},${expensa.metros},${expensa.coeficiente},${expensa.monto},${expensa.estado},${expensa.fecha}\n`;
            });
            
            return csv;
        }

        function downloadCSV(csv, filename) {
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', filename);
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }

        function exportAllData() {
            const allData = {
                exportDate: new Date().toISOString(),
                localesInversores: systemData.localesInversores,
                localesDocks: systemData.localesDocks,
                expensas: systemData.expensas,
                gastos: systemData.gastos,
                reclamos: systemData.reclamos,
                sugerencias: systemData.sugerencias
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', 'backup_sistema_docks.json');
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            
            showNotification('Backup completo descargado', 'success');
        }

        // Notification System
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 4000);
        }

        // Placeholder Functions for Manager Actions
        function openInvestorModal() {
            showNotification('Funcionalidad en desarrollo - Agregar Local Inversor', 'info');
        }

        function openDocksModal() {
            showNotification('Funcionalidad en desarrollo - Agregar Local Propio', 'info');
        }

        function openExpenseOperationalModal() {
            showNotification('Funcionalidad en desarrollo - Registrar Gasto Operativo', 'info');
        }

        function generateExpenses() {
            showNotification('Liquidación de expensas generada automáticamente', 'success');
        }

        function editLocal(id, type) {
            showNotification(`Editar local ${id} (${type})`, 'info');
        }

        function viewContract(id) {
            showNotification(`Ver contrato del local ${id}`, 'info');
        }

        function renewContract(id) {
            showNotification(`Renovar contrato del local ${id}`, 'info');
        }

        function viewExpenseDetail(id) {
            showNotification(`Ver detalle de expensa del local ${id}`, 'info');
        }

        function viewGastoDetail(id) {
            showNotification(`Ver detalle del gasto ${id}`, 'info');
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.getElementsByClassName('modal');
            for (let i = 0; i < modals.length; i++) {
                if (event.target === modals[i]) {
                    modals[i].style.display = 'none';
                }
            }
        };

        // Auto-save every 30 seconds
        setInterval(() => {
            saveToLocalStorage();
        }, 30000);
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDr5VsTEEj79MuV%2BhPFRJ%2BAcYHIztINjv6kOWuQ%2FN7O91MKoPaQAUgXset%2Bbg%2BVNZUpWp2REdb0V2M3Ik%2BeRjc%2BtMq9DXIH896TK%2BufGHLnvgnyQe%2FaH%2FW%2FTlvjQmaC%2BFoaXqpe2Y8DRcmN6rIwBTFHM3IO7Qv3qBoDjytEpQeS7NlDjyCwlvNL22pSqFRakQt07IeuXr3Gxy8ZFarIZxwJC%2BfFDamwWw1eRGngkVOI5T0oVNKwPYE3nHj2c09XlHYWinYNMH7PdkYDOtKQDNU72t9rntyHNcacwLCTGCMWpW6mGHYCIKPd5p2uDNW5RClZ17h%2F5Ip9lvQ9p0KIg13nRF1Rk0DmPAoRSKLPz0Gu1Ez1bf3FzVsh7%2Fgz0dNBcPIxvB5ovOhD7o1E1oe1ggtqr7OR4jzZ6dnibLYvrlitYnpvcoag0zFnabWJszX9qjOOLDNqKL3%2FaYDO%2BAsr8gRwGEYDca2xGFQ1mQr34BAGaR4rli2aQQ3DCAEL3wsG8931JvMIrwlTQhU21Sd72FULw%3D";
        window.__genspark_locale = "es-ES";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDr5VsTEEj79MuV+hPFRJ+AcYHIztINjv6kOWuQ/N7O91MKoPaQAUgXset+bg+VNZUpWp2REdb0V2M3Ik+eRjc+tMq9DXIH896TK+ufGHLnvgnyQe/aH/W/TlvjQmaC+FoaXqpe2Y8DRcmN6rIwBTFHM3IO7Qv3qBoDjytEpQeS7NlDjyCwlvNL22pSqFRakQt07IeuXr3Gxy8ZFarIZxwJC+fFDamwWw1eRGngkVOI5T0oVNKwPYE3nHj2c09XlHYWinYNMH7PdkYDOtKQDNU72t9rntyHNcacwLCTGCMWpW6mGHYCIKPd5p2uDNW5RClZ17h/5Ip9lvQ9p0KIg13nRF1Rk0DmPAoRSKLPz0Gu1Ez1bf3FzVsh7/gz0dNBcPIxvB5ovOhD7o1E1oe1ggtqr7OR4jzZ6dnibLYvrlitYnpvcoag0zFnabWJszX9qjOOLDNqKL3/aYDO+Asr8gRwGEYDca2xGFQ1mQr34BAGaR4rli2aQQ3DCAEL3wsG8931JvMIrwlTQhU21Sd72FULw=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    
